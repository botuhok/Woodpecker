def text_to_array(text_image, width=128, height=32):
    """
    Преобразует текстовое изображение в массив для SSD1306
    text_image: список строк (32 строки по 128 символов)
    Возвращает: список байтов в формате для вашей функции
    """
    # Убедимся, что изображение правильного размера
    if len(text_image) != height:
        raise ValueError(f"Высота должна быть {height} строк")
    
    for i, line in enumerate(text_image):
        if len(line) != width:
            raise ValueError(f"Строка {i}: длина должна быть {width} символов")
    
    # Вычисляем количество страниц (height всегда 32 = 4 страницы по 8 строк)
    pages = height // 8
    array = []
    
    # Преобразуем построчно по страницам
    for page in range(pages):
        page_bytes = []
        for col in range(width):
            byte = 0
            for bit in range(8):
                row = page * 8 + bit
                if row < height:
                    char = text_image[row][col]
                    if char == '#' or char == '@' or char == '1':
                        byte |= (1 << bit)
            page_bytes.append(byte)
        array.extend(page_bytes)
    
    return array

test_image = [
       "            ### #   ### # #                                      ###  #  # ### ###  ##  #  #  ###     #### #  # #  #  ###       ",
       "            # # #   # #  #                                       #  # #  #  #   #  #  # ## # #        #    #  # ## # #          ",
       "            ##  #  ####  #                                       ###  #  #  #   #  #  # # ##  ##      ##   #  # # ## #          ",
       "            #   ## #  #  #                                       #  # #  #  #   #  #  # #  #    #     #    #  # #  # #          ",
       "                                                                 ###   ###  #   #   ##  #  # ###      #     ### #  #  ###       ",
       "                ###                                                                                                             ",
       "               #   #                                             #     # #  # #### #  #     ###  ###  ####  ###  ### #### ###   ",
       "              #     #                                            #     # #  # #    ## #     #  # #  # #    #    #    #    #  #  ",
       "  #   #       #     #         #   #   #                          #  #  # #### ###  # ##     #  # #  # ###   ##   ##  ###  #  #  ",
       "  #   # ###   #     #         #   #  ###                          # # #  #  # #    #  #     # #  ###  #       #    # #    #  #  ",
       "   # #         #   #           # #    #                            ###   #  # #### #  #     #    #  # #### ###  ###  #### ###   ",
       "    #           ###             #                                                                                               ",
       "                                                                 #### #  #      #  # #### #   #                                 ",
       "     ###                    ###                                  #    ## #      # #  #     # #                                  ",
       "    #   #                  #   #                                 ##   # ##      ##   ###    #                                   ",
       "   #     #                #     #                                #    #  #      # #  #      #                                   ",
       "   #     #                #     #                      ###       #    #  #      #  # ####   #                                   ",
       "   #     #                #     #                     #   #                                                                     ",
       "    #   #                  #   #                     #     #                                                                    ",
       "     ###                    ###                      #     #                                                                    ",
       "                ###                                  #     #                                                                    ",
       "               #   #                                  #   #                                                                     ",
       "              #     #                                  ###                                                                      ",
       "              #     #                                                                                                           ",
       "              #     #                               ### #  #                                                                    ",
       "               #   #                                #   ## #                                                                    ",
       "                ###                                 ##  # ##                                                                    ",
       "                                                    #   #  #                                                                    ",
       "         #   # ### #  # #  #                                                                                                    ",
       "         ## ## ##  ## # #  #                                                                                                    ",
       "         # # # #   # ## #  #                                                                                                    ",
       "         #   # ### #  #  ###                                                                                                    ",
    ]
arr = text_to_array(test_image)
for i in range(len(arr)):
    print(arr[i])
